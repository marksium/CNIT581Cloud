services:
  - docker

before_script:
  - echo "Preparing for build..."

script:
  - START_BUILD_TIME=$(date +%s) # Start time for build
  - docker build -t imagetest .
  - END_BUILD_TIME=$(date +%s) # End time for build
  - echo "Build Time: $(($END_BUILD_TIME - $START_BUILD_TIME)) seconds"
  - START_RUN_TIME=$(date +%s) # Start time for run
  - docker run imagetest /bin/sh -c "echo 'Hello from inside the container!'"
  - END_RUN_TIME=$(date +%s) # End time for run
  - echo "Run Time: $(($END_RUN_TIME - $START_RUN_TIME)) seconds"

after_success:
  - echo "Build succeeded!"

after_failure:
  - echo "Build failed!"

before_cache:
  - docker save -o $HOME/docker_cache.tar imagetest

cache:
  directories:
    - $HOME/docker_cache.tar

before_install:
  - docker load -i $HOME/docker_cache.tar || true
